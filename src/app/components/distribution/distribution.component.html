<mat-card class="mat-elevation-z8">
  <div class="text-center">
    <h3>Тақсимкунии соатҳо</h3>
    <h6>
      барои кафедраи "{{ kafedra.fullName | getName:'tj' }}" - и "{{ faculty.fullName }}"
    </h6>
  </div>
</mat-card>
<div>
  <table id="table">
    <tr class="header-load-table">
      <th>№</th>
      <th>Номгӯи фанн</th>
      <th>Курс</th>
      <th>Семестр</th>
      <th>Дараҷаи таҳсил</th>
      <th>Шакли таҳсил</th>
      <th>Гурӯҳ</th>
      <th>
        <mat-icon matTooltip="Шумораи донишҷӯён">group</mat-icon>
      </th>
      <th>Намуд</th>
      <th>Соат</th>
      <th>Омӯзгор</th>
    </tr>
    <ng-template ngFor let-subject let-i="index" [ngForOf]="subjects">
      <tr [class.bg_eee]="i % 2 === 1">
        <td [attr.rowspan]="subject.sections.length">{{ i + 1 }}</td>
        <td [attr.rowspan]="subject.sections.length"
            class="text-left" style="padding-left: 10px;">{{ subject.subjectName }}</td>
        <td [attr.rowspan]="subject.sections.length">{{ subject.course }}</td>
        <td [attr.rowspan]="subject.sections.length">{{ subject.term }}</td>
        <td [attr.rowspan]="subject.sections.length">{{ subject.degree }}</td>
        <td [attr.rowspan]="subject.sections.length">{{ subject.type }}</td>
        <td>
          <div style="overflow: hidden; width: 100%; white-space: nowrap;" *ngFor="let g of subject.sections[0].groups">{{ g }}</div>
        </td>
        <td>{{ subject.sections[0].studentsAmount }}</td>
        <td>{{ subject.sections[0].section }}</td>
        <td>{{ subject.sections[0].hour }}</td>

        <td class="teacher-column">
          <ng-template [ngIf]="subject.sections[0].idTeacher !== ''">
            <div class="toogle" matTooltip="{{subject.sections[0].idTeacher}}">{{ subject.sections[0].idTeacher | teacherName }}</div>
            <div style="float: right;">
              <mat-icon class="md-18"
                        *ngIf="subject.sections[0].isTeacherSaved === true"
                        (click)="deleteTeacherId(+subject.sections[0].id);">delete
              </mat-icon>

              <mat-icon class="md-18"
                        *ngIf="subject.sections[0].isTeacherSaved === false"
                        (click)="connectTeacherWithSubject(subject.sections[0].idTeacher, +subject.sections[0].id)">save
              </mat-icon>
            </div>
          </ng-template>

          <mat-select *ngIf="subject.sections[0].idTeacher === ''"
                      [(value)]="subject.sections[0].idTeacher"
                      placeholder="Интихоб намоед"
                      panelClass="custom-select-panel">
            <mat-option *ngFor="let teacher of teachers" value="{{ teacher.Fio }}">
              {{ teacher.Fio + ' ' +  teacher.Post  }}
            </mat-option>
          </mat-select>
        </td>
      </tr>

      <ng-template [ngIf]="subject.sections.length > 1">
        <ng-template ngFor let-section let-j="index" [ngForOf]="subject.sections">
          <tr [class.bg_eee]="i % 2 === 1" *ngIf="j !== 0">
            <td>
              <div style="overflow: hidden; width: 100%; white-space: nowrap;" *ngFor="let g of section.groups">{{ g }}</div>
            </td>
            <td>{{ section.studentsAmount }}</td>
            <td>{{ section.section }}</td>
            <td>{{ section.hour }}</td>

            <td class="teacher-column">
              <ng-template [ngIf]="section.idTeacher !== ''">
                <div class="toogle" matTooltip="{{section.idTeacher}}">{{ section.idTeacher | teacherName }}</div>
                <div style="float: right;">
                  <mat-icon class="md-18"
                            *ngIf="section.isTeacherSaved === true"
                            (click)="deleteTeacherId(+section.id);">delete
                  </mat-icon>

                  <mat-icon class="md-18"
                            *ngIf="section.isTeacherSaved === false"
                            (click)="connectTeacherWithSubject(section.idTeacher, +section.id)">save
                  </mat-icon>
                </div>
              </ng-template>

              <mat-select *ngIf="section.idTeacher === ''"
                          [(value)]="section.idTeacher"
                          placeholder="Интихоб намоед"
                          panelClass="custom-select-panel">
                <mat-option *ngFor="let teacher of teachers" value="{{ teacher.Fio }}">
                  {{ teacher.Fio + ' ' +  teacher.Post  }}
                </mat-option>
              </mat-select>
            </td>
          </tr>
        </ng-template>
      </ng-template>
    </ng-template>
  </table>
</div>
